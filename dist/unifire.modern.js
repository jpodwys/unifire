export default function(e){const t={},n={};let o,r,s=new Set,c={};const a=new Proxy({},{get:(e,t)=>i(e[t])?e[t](a):e[t],set:(e,t,n)=>(i(e[t])||e[t]===n||(e[t]=c[t]=n,u()),!0)}),i=e=>e instanceof Function,f=(e,t={})=>Object.assign(t,e),d=(e,n)=>(e instanceof Array?s=new Set(e):(s.clear(),e(new Proxy({},{get:(e,t)=>(s.add(t),a[t])}),{})),s.forEach(o=>t[o]&&t[o].add(n||e)),()=>s.forEach(o=>t[o]&&t[o].delete(n||e))),u=()=>{clearTimeout(r),r=setTimeout(()=>{const e=new Set;for(const n in c)c[n]!==o[n]&&t[n]&&t[n].forEach(t=>e.add(t));e.forEach(e=>e(a,o)),c={},o=f(a)})},w=(e,t)=>n[e]&&n[e]({state:a,fire:w},t),b=e=>{e instanceof Array||(e=[e]);for(const{state:r,actions:s,subscribers:c}in e){for(const e in r)t[e]=new Set;f(s,n),f(r,a),o=f(a);for(const e in r)i(r[e])&&d(r[e],()=>t[e].forEach(e=>e(a,o)));for(const e in c)d(e)}};return b(e),{state:a,fire:w,subscribe:d,register:b}}
//# sourceMappingURL=unifire.modern.js.map
